local year = 1979
foreach i of varlist R0217500 R0405600 R0618600 R0898400 R1144900 R1520100 R1890800 R2257900 R2445300 R2870900 R3074600 R3401300 R3656700 R4007200 R4418300 R5081300 R5166600 R6479200 R7006900 R7704200 R8496600 T0988400 T2210400 T3108300 T4112800 T5023200 T5771100 T8219200 {
	rename `i' MARITAL_STAT_`year'
	if `year' >= 1994 local year = `year' + 2
	if `year' <= 1993 local ++year
}

local year = 1979
foreach i of varlist R0217502 R0405210 R0647103 R0896710 R1144410 R1519610 R1890210 R2257410 R2444610 R2870110 R3073910 R3400600 R3656000 R4006500 R4417600 R5080600 R5165900 R6478600 R7006400 R7703600 R8496000 T0987600 T2209900 T3107700 T4112200 T5022500 T5770700 T8218600 {
	rename `i' FAM_SIZE_`year'
	if `year' >= 1994 local year = `year' + 2
	if `year' <= 1993 local ++year
}

local year = 1979
foreach i of varlist R0215700 R0407200 R0646300 R0896900 R1145300 R1520500 R1891200 R2258300 R2445700 R2871500 R3075200 R3401900 R3657300 R4007800 R4418900 R5081900 R5167200 R6480000 R7007700 R7705000 R8497400 T0989200 T2211000 T3108900 T4113400 T5024800 T5772800 T8220000 {
	rename `i' WKS_WORKED_`year'
	if `year' >= 1994 local year = `year' + 2
	if `year' <= 1993 local ++year
}

local year = 1982
foreach i of varlist R0780300 R1021900 R1391000 R1774600 R2716600 R2968200 R4979200 R7606400 T0911100 T2075400 T3044000 T3976200 T4914500 {
	rename `i' ALCOLHOL_`year'
	if `year' >= 2006 local year = `year' + 2
	if `year' == 2002 local year = 2006
	if `year' == 1994 local year = 2002
	if `year' == 1989 local year = 1994
	if `year' == 1988 local ++year
	if `year' == 1985 local year = 1988
	if `year' < 1985 local ++year
}

local year = 1984
foreach i of varlist R1395700 R2721100 R3915300 R5053400 R6430700 {
	rename `i' MARIJUANA_`year'
	local year = `year' + 4
}

local year = 1984
foreach i of varlist R1404100 R2721200 R3915400 R5053500 R6430800 {
	rename `i' COCAINE_LIFE_`year'
	local year = `year' + 4
}

qui reshape long MARITAL_STAT_ FAM_SIZE_ WKS_WORKED_ ALCOLHOL_ MARIJUANA_ COCAINE_LIFE_, i(R0000100) j(year)

rename *_ *
