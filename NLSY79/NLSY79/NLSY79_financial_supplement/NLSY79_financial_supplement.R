
# Set working directory
# setwd()


new_data <- read.table('NLSY79_financial_supplement.dat', sep=' ')
names(new_data) <- c('R0000100',
'R0173600',
'R0214700',
'R0214800',
'R2736100',
'R2736201',
'R2983600',
'R2983701',
'R3294000',
'R3294101',
'R3911700',
'R3911801',
'R4393100',
'R4393201',
'R5047900',
'R5048001',
'R5729300',
'R5729401',
'R6427300',
'R6427401',
'R6946100',
'R6946201',
'R8365400',
'R8376100',
'R8376400',
'T2129100',
'T2139800',
'T2140100',
'T4030400',
'T4042600',
'T4042900',
'T5668100',
'T5681500',
'T5681800',
'X0045800',
'X0045900',
'X0061200',
'X0061300',
'X0061400',
'X0061500',
'X0062000')


# Handle missing values

new_data[new_data == -1] = NA  # Refused
new_data[new_data == -2] = NA  # Dont know
new_data[new_data == -3] = NA  # Invalid missing
new_data[new_data == -4] = NA  # Valid missing
new_data[new_data == -5] = NA  # Non-interview


# If there are values not categorized they will be represented as NA

vallabels = function(data) {
  data$R0173600 <- factor(data$R0173600,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0),
labels=c("CROSS MALE WHITE",
"CROSS MALE WH. POOR",
"CROSS MALE BLACK",
"CROSS MALE HISPANIC",
"CROSS FEMALE WHITE",
"CROSS FEMALE WH POOR",
"CROSS FEMALE BLACK",
"CROSS FEMALE HISPANIC",
"SUP MALE WH POOR",
"SUP MALE BLACK",
"SUP MALE HISPANIC",
"SUP FEM WH POOR",
"SUP FEMALE BLACK",
"SUP FEMALE HISPANIC",
"MIL MALE WHITE",
"MIL MALE BLACK",
"MIL MALE HISPANIC",
"MIL FEMALE WHITE",
"MIL FEMALE BLACK",
"MIL FEMALE HISPANIC"))
  data$R0214700 <- factor(data$R0214700,
levels=c(1.0,2.0,3.0),
labels=c("HISPANIC",
"BLACK",
"NON-BLACK, NON-HISPANIC"))
  data$R0214800 <- factor(data$R0214800,
levels=c(1.0,2.0),
labels=c("MALE",
"FEMALE"))
  data$R2736100 <- factor(data$R2736100,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R2983600 <- factor(data$R2983600,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R3294000 <- factor(data$R3294000,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R3911700 <- factor(data$R3911700,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R4393100 <- factor(data$R4393100,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R5047900 <- factor(data$R5047900,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R5729300 <- factor(data$R5729300,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R6427300 <- factor(data$R6427300,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R6946100 <- factor(data$R6946100,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$R8365400 <- factor(data$R8365400,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$R8376100 <- factor(data$R8376100,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$T2129100 <- factor(data$T2129100,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$T2139800 <- factor(data$T2139800,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$T4030400 <- factor(data$T4030400,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$T4042600 <- factor(data$T4042600,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$T5668100 <- factor(data$T5668100,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$T5681500 <- factor(data$T5681500,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$X0045800 <- factor(data$X0045800,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$X0061200 <- factor(data$X0061200,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$X0061300 <- factor(data$X0061300,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$X0061400 <- factor(data$X0061400,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$X0061500 <- factor(data$X0061500,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$X0062000 <- factor(data$X0062000,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
return(data)
}


# If there are values not categorized they will be represented as NA

vallabels_continuous = function(data) {
data$R2736201[1.0 <= data$R2736201 & data$R2736201 <= 4999.0] <- 1.0
data$R2736201[5000.0 <= data$R2736201 & data$R2736201 <= 9999.0] <- 5000.0
data$R2736201[10000.0 <= data$R2736201 & data$R2736201 <= 14999.0] <- 10000.0
data$R2736201[15000.0 <= data$R2736201 & data$R2736201 <= 19999.0] <- 15000.0
data$R2736201[20000.0 <= data$R2736201 & data$R2736201 <= 24999.0] <- 20000.0
data$R2736201[25000.0 <= data$R2736201 & data$R2736201 <= 29999.0] <- 25000.0
data$R2736201[30000.0 <= data$R2736201 & data$R2736201 <= 39999.0] <- 30000.0
data$R2736201[40000.0 <= data$R2736201 & data$R2736201 <= 49999.0] <- 40000.0
data$R2736201[50000.0 <= data$R2736201 & data$R2736201 <= 59999.0] <- 50000.0
data$R2736201[60000.0 <= data$R2736201 & data$R2736201 <= 69999.0] <- 60000.0
data$R2736201[70000.0 <= data$R2736201 & data$R2736201 <= 79999.0] <- 70000.0
data$R2736201[80000.0 <= data$R2736201 & data$R2736201 <= 89999.0] <- 80000.0
data$R2736201[90000.0 <= data$R2736201 & data$R2736201 <= 99999.0] <- 90000.0
data$R2736201[100000.0 <= data$R2736201 & data$R2736201 <= 149999.0] <- 100000.0
data$R2736201[150000.0 <= data$R2736201 & data$R2736201 <= 9999999.0] <- 150000.0
data$R2736201 <- factor(data$R2736201,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 9999999: 150000+"))
data$R2983701[1.0 <= data$R2983701 & data$R2983701 <= 499.0] <- 1.0
data$R2983701[500.0 <= data$R2983701 & data$R2983701 <= 999.0] <- 500.0
data$R2983701[1000.0 <= data$R2983701 & data$R2983701 <= 1499.0] <- 1000.0
data$R2983701[1500.0 <= data$R2983701 & data$R2983701 <= 1999.0] <- 1500.0
data$R2983701[2000.0 <= data$R2983701 & data$R2983701 <= 2499.0] <- 2000.0
data$R2983701[2500.0 <= data$R2983701 & data$R2983701 <= 2999.0] <- 2500.0
data$R2983701[3000.0 <= data$R2983701 & data$R2983701 <= 3499.0] <- 3000.0
data$R2983701[3500.0 <= data$R2983701 & data$R2983701 <= 3999.0] <- 3500.0
data$R2983701[4000.0 <= data$R2983701 & data$R2983701 <= 4499.0] <- 4000.0
data$R2983701[4500.0 <= data$R2983701 & data$R2983701 <= 4999.0] <- 4500.0
data$R2983701[5000.0 <= data$R2983701 & data$R2983701 <= 9999999.0] <- 5000.0
data$R2983701 <- factor(data$R2983701,
levels=c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0),
labels=c("0",
"1 TO 499",
"500 TO 999",
"1000 TO 1499",
"1500 TO 1999",
"2000 TO 2499",
"2500 TO 2999",
"3000 TO 3499",
"3500 TO 3999",
"4000 TO 4499",
"4500 TO 4999",
"5000 TO 9999999: 5000+"))
data$R3294101[1.0 <= data$R3294101 & data$R3294101 <= 499.0] <- 1.0
data$R3294101[500.0 <= data$R3294101 & data$R3294101 <= 999.0] <- 500.0
data$R3294101[1000.0 <= data$R3294101 & data$R3294101 <= 1499.0] <- 1000.0
data$R3294101[1500.0 <= data$R3294101 & data$R3294101 <= 1999.0] <- 1500.0
data$R3294101[2000.0 <= data$R3294101 & data$R3294101 <= 2499.0] <- 2000.0
data$R3294101[2500.0 <= data$R3294101 & data$R3294101 <= 2999.0] <- 2500.0
data$R3294101[3000.0 <= data$R3294101 & data$R3294101 <= 3499.0] <- 3000.0
data$R3294101[3500.0 <= data$R3294101 & data$R3294101 <= 3999.0] <- 3500.0
data$R3294101[4000.0 <= data$R3294101 & data$R3294101 <= 4499.0] <- 4000.0
data$R3294101[4500.0 <= data$R3294101 & data$R3294101 <= 4999.0] <- 4500.0
data$R3294101[5000.0 <= data$R3294101 & data$R3294101 <= 9999999.0] <- 5000.0
data$R3294101 <- factor(data$R3294101,
levels=c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0),
labels=c("0",
"1 TO 499",
"500 TO 999",
"1000 TO 1499",
"1500 TO 1999",
"2000 TO 2499",
"2500 TO 2999",
"3000 TO 3499",
"3500 TO 3999",
"4000 TO 4499",
"4500 TO 4999",
"5000 TO 9999999: 5000+"))
data$R3911801[1.0 <= data$R3911801 & data$R3911801 <= 499.0] <- 1.0
data$R3911801[500.0 <= data$R3911801 & data$R3911801 <= 999.0] <- 500.0
data$R3911801[1000.0 <= data$R3911801 & data$R3911801 <= 1499.0] <- 1000.0
data$R3911801[1500.0 <= data$R3911801 & data$R3911801 <= 1999.0] <- 1500.0
data$R3911801[2000.0 <= data$R3911801 & data$R3911801 <= 2499.0] <- 2000.0
data$R3911801[2500.0 <= data$R3911801 & data$R3911801 <= 2999.0] <- 2500.0
data$R3911801[3000.0 <= data$R3911801 & data$R3911801 <= 3499.0] <- 3000.0
data$R3911801[3500.0 <= data$R3911801 & data$R3911801 <= 3999.0] <- 3500.0
data$R3911801[4000.0 <= data$R3911801 & data$R3911801 <= 4499.0] <- 4000.0
data$R3911801[4500.0 <= data$R3911801 & data$R3911801 <= 4999.0] <- 4500.0
data$R3911801[5000.0 <= data$R3911801 & data$R3911801 <= 9999999.0] <- 5000.0
data$R3911801 <- factor(data$R3911801,
levels=c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0),
labels=c("0",
"1 TO 499",
"500 TO 999",
"1000 TO 1499",
"1500 TO 1999",
"2000 TO 2499",
"2500 TO 2999",
"3000 TO 3499",
"3500 TO 3999",
"4000 TO 4499",
"4500 TO 4999",
"5000 TO 9999999: 5000+"))
data$R4393201[1.0 <= data$R4393201 & data$R4393201 <= 4999.0] <- 1.0
data$R4393201[5000.0 <= data$R4393201 & data$R4393201 <= 9999.0] <- 5000.0
data$R4393201[10000.0 <= data$R4393201 & data$R4393201 <= 14999.0] <- 10000.0
data$R4393201[15000.0 <= data$R4393201 & data$R4393201 <= 19999.0] <- 15000.0
data$R4393201[20000.0 <= data$R4393201 & data$R4393201 <= 24999.0] <- 20000.0
data$R4393201[25000.0 <= data$R4393201 & data$R4393201 <= 29999.0] <- 25000.0
data$R4393201[30000.0 <= data$R4393201 & data$R4393201 <= 39999.0] <- 30000.0
data$R4393201[40000.0 <= data$R4393201 & data$R4393201 <= 49999.0] <- 40000.0
data$R4393201[50000.0 <= data$R4393201 & data$R4393201 <= 59999.0] <- 50000.0
data$R4393201[60000.0 <= data$R4393201 & data$R4393201 <= 69999.0] <- 60000.0
data$R4393201[70000.0 <= data$R4393201 & data$R4393201 <= 79999.0] <- 70000.0
data$R4393201[80000.0 <= data$R4393201 & data$R4393201 <= 89999.0] <- 80000.0
data$R4393201[90000.0 <= data$R4393201 & data$R4393201 <= 99999.0] <- 90000.0
data$R4393201[100000.0 <= data$R4393201 & data$R4393201 <= 149999.0] <- 100000.0
data$R4393201[150000.0 <= data$R4393201 & data$R4393201 <= 9999999.0] <- 150000.0
data$R4393201 <- factor(data$R4393201,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 9999999: 150000+"))
data$R5048001[1.0 <= data$R5048001 & data$R5048001 <= 4999.0] <- 1.0
data$R5048001[5000.0 <= data$R5048001 & data$R5048001 <= 9999.0] <- 5000.0
data$R5048001[10000.0 <= data$R5048001 & data$R5048001 <= 14999.0] <- 10000.0
data$R5048001[15000.0 <= data$R5048001 & data$R5048001 <= 19999.0] <- 15000.0
data$R5048001[20000.0 <= data$R5048001 & data$R5048001 <= 24999.0] <- 20000.0
data$R5048001[25000.0 <= data$R5048001 & data$R5048001 <= 29999.0] <- 25000.0
data$R5048001[30000.0 <= data$R5048001 & data$R5048001 <= 39999.0] <- 30000.0
data$R5048001[40000.0 <= data$R5048001 & data$R5048001 <= 49999.0] <- 40000.0
data$R5048001[50000.0 <= data$R5048001 & data$R5048001 <= 59999.0] <- 50000.0
data$R5048001[60000.0 <= data$R5048001 & data$R5048001 <= 69999.0] <- 60000.0
data$R5048001[70000.0 <= data$R5048001 & data$R5048001 <= 79999.0] <- 70000.0
data$R5048001[80000.0 <= data$R5048001 & data$R5048001 <= 89999.0] <- 80000.0
data$R5048001[90000.0 <= data$R5048001 & data$R5048001 <= 99999.0] <- 90000.0
data$R5048001[100000.0 <= data$R5048001 & data$R5048001 <= 149999.0] <- 100000.0
data$R5048001[150000.0 <= data$R5048001 & data$R5048001 <= 9.9999999E7] <- 150000.0
data$R5048001 <- factor(data$R5048001,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$R5729401[1.0 <= data$R5729401 & data$R5729401 <= 4999.0] <- 1.0
data$R5729401[5000.0 <= data$R5729401 & data$R5729401 <= 9999.0] <- 5000.0
data$R5729401[10000.0 <= data$R5729401 & data$R5729401 <= 14999.0] <- 10000.0
data$R5729401[15000.0 <= data$R5729401 & data$R5729401 <= 19999.0] <- 15000.0
data$R5729401[20000.0 <= data$R5729401 & data$R5729401 <= 24999.0] <- 20000.0
data$R5729401[25000.0 <= data$R5729401 & data$R5729401 <= 29999.0] <- 25000.0
data$R5729401[30000.0 <= data$R5729401 & data$R5729401 <= 39999.0] <- 30000.0
data$R5729401[40000.0 <= data$R5729401 & data$R5729401 <= 49999.0] <- 40000.0
data$R5729401[50000.0 <= data$R5729401 & data$R5729401 <= 59999.0] <- 50000.0
data$R5729401[60000.0 <= data$R5729401 & data$R5729401 <= 69999.0] <- 60000.0
data$R5729401[70000.0 <= data$R5729401 & data$R5729401 <= 79999.0] <- 70000.0
data$R5729401[80000.0 <= data$R5729401 & data$R5729401 <= 89999.0] <- 80000.0
data$R5729401[90000.0 <= data$R5729401 & data$R5729401 <= 99999.0] <- 90000.0
data$R5729401[100000.0 <= data$R5729401 & data$R5729401 <= 149999.0] <- 100000.0
data$R5729401[150000.0 <= data$R5729401 & data$R5729401 <= 9.9999999E7] <- 150000.0
data$R5729401 <- factor(data$R5729401,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$R6427401[1.0 <= data$R6427401 & data$R6427401 <= 4999.0] <- 1.0
data$R6427401[5000.0 <= data$R6427401 & data$R6427401 <= 9999.0] <- 5000.0
data$R6427401[10000.0 <= data$R6427401 & data$R6427401 <= 14999.0] <- 10000.0
data$R6427401[15000.0 <= data$R6427401 & data$R6427401 <= 19999.0] <- 15000.0
data$R6427401[20000.0 <= data$R6427401 & data$R6427401 <= 24999.0] <- 20000.0
data$R6427401[25000.0 <= data$R6427401 & data$R6427401 <= 29999.0] <- 25000.0
data$R6427401[30000.0 <= data$R6427401 & data$R6427401 <= 39999.0] <- 30000.0
data$R6427401[40000.0 <= data$R6427401 & data$R6427401 <= 49999.0] <- 40000.0
data$R6427401[50000.0 <= data$R6427401 & data$R6427401 <= 59999.0] <- 50000.0
data$R6427401[60000.0 <= data$R6427401 & data$R6427401 <= 69999.0] <- 60000.0
data$R6427401[70000.0 <= data$R6427401 & data$R6427401 <= 79999.0] <- 70000.0
data$R6427401[80000.0 <= data$R6427401 & data$R6427401 <= 89999.0] <- 80000.0
data$R6427401[90000.0 <= data$R6427401 & data$R6427401 <= 99999.0] <- 90000.0
data$R6427401[100000.0 <= data$R6427401 & data$R6427401 <= 149999.0] <- 100000.0
data$R6427401[150000.0 <= data$R6427401 & data$R6427401 <= 9.9999999E7] <- 150000.0
data$R6427401 <- factor(data$R6427401,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$R6946201[1.0 <= data$R6946201 & data$R6946201 <= 4999.0] <- 1.0
data$R6946201[5000.0 <= data$R6946201 & data$R6946201 <= 9999.0] <- 5000.0
data$R6946201[10000.0 <= data$R6946201 & data$R6946201 <= 14999.0] <- 10000.0
data$R6946201[15000.0 <= data$R6946201 & data$R6946201 <= 19999.0] <- 15000.0
data$R6946201[20000.0 <= data$R6946201 & data$R6946201 <= 24999.0] <- 20000.0
data$R6946201[25000.0 <= data$R6946201 & data$R6946201 <= 29999.0] <- 25000.0
data$R6946201[30000.0 <= data$R6946201 & data$R6946201 <= 39999.0] <- 30000.0
data$R6946201[40000.0 <= data$R6946201 & data$R6946201 <= 49999.0] <- 40000.0
data$R6946201[50000.0 <= data$R6946201 & data$R6946201 <= 59999.0] <- 50000.0
data$R6946201[60000.0 <= data$R6946201 & data$R6946201 <= 69999.0] <- 60000.0
data$R6946201[70000.0 <= data$R6946201 & data$R6946201 <= 79999.0] <- 70000.0
data$R6946201[80000.0 <= data$R6946201 & data$R6946201 <= 89999.0] <- 80000.0
data$R6946201[90000.0 <= data$R6946201 & data$R6946201 <= 99999.0] <- 90000.0
data$R6946201[100000.0 <= data$R6946201 & data$R6946201 <= 149999.0] <- 100000.0
data$R6946201[150000.0 <= data$R6946201 & data$R6946201 <= 9.9999999E7] <- 150000.0
data$R6946201 <- factor(data$R6946201,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$R8376400[1.0 <= data$R8376400 & data$R8376400 <= 4999.0] <- 1.0
data$R8376400[5000.0 <= data$R8376400 & data$R8376400 <= 9999.0] <- 5000.0
data$R8376400[10000.0 <= data$R8376400 & data$R8376400 <= 14999.0] <- 10000.0
data$R8376400[15000.0 <= data$R8376400 & data$R8376400 <= 19999.0] <- 15000.0
data$R8376400[20000.0 <= data$R8376400 & data$R8376400 <= 24999.0] <- 20000.0
data$R8376400[25000.0 <= data$R8376400 & data$R8376400 <= 29999.0] <- 25000.0
data$R8376400[30000.0 <= data$R8376400 & data$R8376400 <= 39999.0] <- 30000.0
data$R8376400[40000.0 <= data$R8376400 & data$R8376400 <= 49999.0] <- 40000.0
data$R8376400[50000.0 <= data$R8376400 & data$R8376400 <= 59999.0] <- 50000.0
data$R8376400[60000.0 <= data$R8376400 & data$R8376400 <= 69999.0] <- 60000.0
data$R8376400[70000.0 <= data$R8376400 & data$R8376400 <= 79999.0] <- 70000.0
data$R8376400[80000.0 <= data$R8376400 & data$R8376400 <= 89999.0] <- 80000.0
data$R8376400[90000.0 <= data$R8376400 & data$R8376400 <= 99999.0] <- 90000.0
data$R8376400[100000.0 <= data$R8376400 & data$R8376400 <= 149999.0] <- 100000.0
data$R8376400[150000.0 <= data$R8376400 & data$R8376400 <= 9.999999999E9] <- 150000.0
data$R8376400 <- factor(data$R8376400,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 9999999999: 150000+"))
data$T2140100[1.0 <= data$T2140100 & data$T2140100 <= 4999.0] <- 1.0
data$T2140100[5000.0 <= data$T2140100 & data$T2140100 <= 9999.0] <- 5000.0
data$T2140100[10000.0 <= data$T2140100 & data$T2140100 <= 14999.0] <- 10000.0
data$T2140100[15000.0 <= data$T2140100 & data$T2140100 <= 19999.0] <- 15000.0
data$T2140100[20000.0 <= data$T2140100 & data$T2140100 <= 24999.0] <- 20000.0
data$T2140100[25000.0 <= data$T2140100 & data$T2140100 <= 29999.0] <- 25000.0
data$T2140100[30000.0 <= data$T2140100 & data$T2140100 <= 39999.0] <- 30000.0
data$T2140100[40000.0 <= data$T2140100 & data$T2140100 <= 49999.0] <- 40000.0
data$T2140100[50000.0 <= data$T2140100 & data$T2140100 <= 59999.0] <- 50000.0
data$T2140100[60000.0 <= data$T2140100 & data$T2140100 <= 69999.0] <- 60000.0
data$T2140100[70000.0 <= data$T2140100 & data$T2140100 <= 79999.0] <- 70000.0
data$T2140100[80000.0 <= data$T2140100 & data$T2140100 <= 89999.0] <- 80000.0
data$T2140100[90000.0 <= data$T2140100 & data$T2140100 <= 99999.0] <- 90000.0
data$T2140100[100000.0 <= data$T2140100 & data$T2140100 <= 149999.0] <- 100000.0
data$T2140100[150000.0 <= data$T2140100 & data$T2140100 <= 9.9999999E7] <- 150000.0
data$T2140100 <- factor(data$T2140100,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$T4042900[1.0 <= data$T4042900 & data$T4042900 <= 4999.0] <- 1.0
data$T4042900[5000.0 <= data$T4042900 & data$T4042900 <= 9999.0] <- 5000.0
data$T4042900[10000.0 <= data$T4042900 & data$T4042900 <= 14999.0] <- 10000.0
data$T4042900[15000.0 <= data$T4042900 & data$T4042900 <= 19999.0] <- 15000.0
data$T4042900[20000.0 <= data$T4042900 & data$T4042900 <= 24999.0] <- 20000.0
data$T4042900[25000.0 <= data$T4042900 & data$T4042900 <= 29999.0] <- 25000.0
data$T4042900[30000.0 <= data$T4042900 & data$T4042900 <= 39999.0] <- 30000.0
data$T4042900[40000.0 <= data$T4042900 & data$T4042900 <= 49999.0] <- 40000.0
data$T4042900[50000.0 <= data$T4042900 & data$T4042900 <= 59999.0] <- 50000.0
data$T4042900[60000.0 <= data$T4042900 & data$T4042900 <= 69999.0] <- 60000.0
data$T4042900[70000.0 <= data$T4042900 & data$T4042900 <= 79999.0] <- 70000.0
data$T4042900[80000.0 <= data$T4042900 & data$T4042900 <= 89999.0] <- 80000.0
data$T4042900[90000.0 <= data$T4042900 & data$T4042900 <= 99999.0] <- 90000.0
data$T4042900[100000.0 <= data$T4042900 & data$T4042900 <= 149999.0] <- 100000.0
data$T4042900[150000.0 <= data$T4042900 & data$T4042900 <= 9.9999999E7] <- 150000.0
data$T4042900 <- factor(data$T4042900,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$T5681800[1.0 <= data$T5681800 & data$T5681800 <= 4999.0] <- 1.0
data$T5681800[5000.0 <= data$T5681800 & data$T5681800 <= 9999.0] <- 5000.0
data$T5681800[10000.0 <= data$T5681800 & data$T5681800 <= 14999.0] <- 10000.0
data$T5681800[15000.0 <= data$T5681800 & data$T5681800 <= 19999.0] <- 15000.0
data$T5681800[20000.0 <= data$T5681800 & data$T5681800 <= 24999.0] <- 20000.0
data$T5681800[25000.0 <= data$T5681800 & data$T5681800 <= 29999.0] <- 25000.0
data$T5681800[30000.0 <= data$T5681800 & data$T5681800 <= 39999.0] <- 30000.0
data$T5681800[40000.0 <= data$T5681800 & data$T5681800 <= 49999.0] <- 40000.0
data$T5681800[50000.0 <= data$T5681800 & data$T5681800 <= 59999.0] <- 50000.0
data$T5681800[60000.0 <= data$T5681800 & data$T5681800 <= 69999.0] <- 60000.0
data$T5681800[70000.0 <= data$T5681800 & data$T5681800 <= 79999.0] <- 70000.0
data$T5681800[80000.0 <= data$T5681800 & data$T5681800 <= 89999.0] <- 80000.0
data$T5681800[90000.0 <= data$T5681800 & data$T5681800 <= 99999.0] <- 90000.0
data$T5681800[100000.0 <= data$T5681800 & data$T5681800 <= 149999.0] <- 100000.0
data$T5681800[150000.0 <= data$T5681800 & data$T5681800 <= 9.9999999E7] <- 150000.0
data$T5681800 <- factor(data$T5681800,
levels=c(0.0,1.0,5000.0,10000.0,15000.0,20000.0,25000.0,30000.0,40000.0,50000.0,60000.0,70000.0,80000.0,90000.0,100000.0,150000.0),
labels=c("0",
"1 TO 4999",
"5000 TO 9999",
"10000 TO 14999",
"15000 TO 19999",
"20000 TO 24999",
"25000 TO 29999",
"30000 TO 39999",
"40000 TO 49999",
"50000 TO 59999",
"60000 TO 69999",
"70000 TO 79999",
"80000 TO 89999",
"90000 TO 99999",
"100000 TO 149999",
"150000 TO 99999999: 150000+"))
data$X0045900[15.0 <= data$X0045900 & data$X0045900 <= 99.0] <- 15.0
data$X0045900 <- factor(data$X0045900,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0),
labels=c("0",
"1",
"2",
"3",
"4",
"5",
"6",
"7",
"8",
"9",
"10",
"11",
"12",
"13",
"14",
"15 TO 99: 15+"))
return(data)
}

varlabels <- c("ID# (1-12686) 79",
"SAMPLE ID  79 INT",
"RACL/ETHNIC COHORT /SCRNR 79",
"SEX OF R 79",
"R/SP HAVE STOCK/BONDS/MUTUAL FUNDS 88",
"MKT VAL OF STOCKS,BONDS R-SP HAVE (TRUNC)",
"R/SP HAVE STOCK/BONDS/MUTUAL FUNDS 89",
"MKT VAL OF STOCKS,BONDS R-SP HAVE (TRUNC)",
"R/SP HAVE STOCK/BONDS/MUTUAL FUNDS 90",
"MKT VAL OF STOCKS,BONDS R-SP HAVE (TRUNC)",
"R/SP HAVE STOCK/BONDS/MUTUAL FUNDS 92",
"MKT VAL OF STOCKS,BONDS R-SP HAVE (TRUNC)",
"R/SP HAVE COMMON STOCK,BONDS? 93",
"MKT VAL OF STOCKS,BONDS R-SP HAVE (TRUNC)",
"R/SP HAVE COMMON STOCK,BONDS? 94",
"MKT VAL OF STOCKS,BONDS R-SP HAVE (TRUNC)",
"R/SP HAVE COMMON STOCK,BONDS? 96",
"MKT VAL OF STOCKS,BONDS R-SP HAVE 96",
"R/SP HAVE COMMON STOCK,BONDS? 1998",
"MKT VAL OF STOCKS,BONDS R-SP HAVE 1998",
"R/SP HAVE COMMON STOCK,BONDS? 2000",
"MKT VAL OF STOCKS,BONDS R-SP HAVE 2000",
"R-SPOUSE OWN MUTUAL FUNDS 2004",
"R-SPOUSE OWN ANY SHARES OF STOCK 2004",
"AMT R-SP HAVE IF SOLD/PAY STOCKS 2004",
"R-SPOUSE OWN MUTUAL FUNDS 2008",
"R-SPOUSE OWN ANY SHARES OF STOCK 2008",
"AMT R-SP HAVE IF SOLD/PAY STOCKS 2008",
"R-SPOUSE OWN MUTUAL FUNDS 2012",
"R-SPOUSE OWN ANY SHARES OF STOCK 2012",
"AMT R-SP HAVE IF SOLD/PAY STOCKS 2012",
"R-SPOUSE OWN MUTUAL FUNDS 2016",
"R-SPOUSE OWN ANY SHARES OF STOCK 2016",
"AMT R-SP HAVE IF SOLD/PAY STOCKS 2016",
"R EVER OWNED A BUSINESS XRND",
"NUMBER OF BUSINESSES R EVER OWNED XRND",
"ANY R FAM MEM EVER OWNED A BUS PRIOR TO ACQ R BUS XRND",
"ANY OF R FAMILY MEMBERS EVER OWED A BUS XRND",
"R WRK FOR ANY OF THOSE FAM MEM PRIOR ACQ R BUS XRND",
"R WORKED FOR ANY OF THOSE FAMILY MEMBERS XRND",
"R CONSIDERS R TO BE AN ENTREPRENEUR XRND"
)


# Use qnames rather than rnums

qnames = function(data) {
names(data) <- c("CASEID_1979",
"SAMPLE_ID_1979",
"SAMPLE_RACE_78SCRN",
"SAMPLE_SEX_1979",
"Q13-124_1988",
"Q13-125_REVISED_1988",
"Q13-124_1989",
"Q13-125_REVISED_1989",
"Q13-124_1990",
"Q13-125_REVISED_1990",
"Q13-124_1992",
"Q13-125_REVISED_1992",
"Q13-124_1993",
"Q13-125_REVISED_1993",
"Q13-124_1994",
"Q13-125_REVISED_1994",
"Q13-124_1996",
"Q13-125_REVISED_1996",
"Q13-124_1998",
"Q13-125_REVISED_1998",
"Q13-124_2000",
"Q13-125_REVISED_2000",
"FA_4_2004",
"FA_9_2004",
"FA_9A_TRUNC_2004",
"FA_4_2008",
"FA_9_2008",
"FA_9A_TRUNC_2008",
"FA_4_2012",
"FA_9_2012",
"FA_9A_TRUNC_2012",
"FA_4_2016",
"FA_9_2016",
"FA_9A_TRUNC_2016",
"BUSOWN-1_XRND",
"BUSOWN-2_XRND",
"BUSOWN-23A_XRND",
"BUSOWN-23B_XRND",
"BUSOWN-24A_XRND",
"BUSOWN-24B_XRND",
"BUSOWN-29_XRND")
return(data)
}


#********************************************************************************************************

# Remove the '#' before the following line to create a data file called "categories" with value labels.
#categories <- vallabels(new_data)

# Remove the '#' before the following lines to rename variables using Qnames instead of Reference Numbers
#new_data <- qnames(new_data)
#categories <- qnames(categories)

# Produce summaries for the raw (uncategorized) data file
summary(new_data)

# Remove the '#' before the following lines to produce summaries for the "categories" data file.
#categories <- vallabels(new_data)
#categories <- vallabels_continuous(new_data)
#summary(categories)

#************************************************************************************************************

