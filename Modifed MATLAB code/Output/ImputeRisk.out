
disp('Output from ImputeRisk.m - August 21 2023');
Output from ImputeRisk.m - August 21 2023
disp('  ');
  

%% Input NLSY79 data %%
% input all variables including indicator dummy (instead of categorical
% variable)

[ID, INCOME_1993, INTERVIEW_MONTH_1993, WKS_WORKED_SPS_1993, WKS_WORKED_1993, ...
    EAST_1993, SOUTH_1993, WEST_1993, MARRIED_1993, OTHER_1993, HS_1993, COLLEGE_1993, RISK_1993, AGE_1993, lINCOME_1993, zINCOME_1993, ...
    INCOME_2002, INTERVIEW_MONTH_2002, WKS_WORKED_SPS_2002, WKS_WORKED_2002, ...
    EAST_2002, SOUTH_2002, WEST_2002, MARRIED_2002, OTHER_2002, HS_2002, COLLEGE_2002, RISK_2002, AGE_2002, lINCOME_2002, zINCOME_2002,...
    INCOME_2004, INTERVIEW_MONTH_2004, WKS_WORKED_SPS_2004, WKS_WORKED_2004, ...
    EAST_2004, SOUTH_2004, WEST_2004, MARRIED_2004, OTHER_2004, HS_2004, COLLEGE_2004, RISK_2004, AGE_2004, lINCOME_2004, zINCOME_2004,...
    INCOME_2006, INTERVIEW_MONTH_2006, WKS_WORKED_SPS_2006, WKS_WORKED_2006, ...
    EAST_2006, SOUTH_2006, WEST_2006, MARRIED_2006, OTHER_2006, HS_2006, COLLEGE_2006, RISK_2006, AGE_2006, lINCOME_2006, zINCOME_2006,...
    INCOME_2010, INTERVIEW_MONTH_2010, WKS_WORKED_SPS_2010, WKS_WORKED_2010, ...
    EAST_2010, SOUTH_2010, WEST_2010, MARRIED_2010, OTHER_2010, HS_2010, COLLEGE_2010, RISK_2010, AGE_2010, lINCOME_2010, zINCOME_2010,...
    INCOME_2012, INTERVIEW_MONTH_2012, WKS_WORKED_SPS_2012, WKS_WORKED_2012, ...
    EAST_2012, SOUTH_2012, WEST_2012, MARRIED_2012, OTHER_2012, HS_2012, COLLEGE_2012, RISK_2012, AGE_2012, lINCOME_2012, zINCOME_2012,...
    INCOME_2014, INTERVIEW_MONTH_2014, WKS_WORKED_SPS_2014, WKS_WORKED_2014, ...
    EAST_2014, SOUTH_2014, WEST_2014, MARRIED_2014, OTHER_2014, HS_2014, COLLEGE_2014, RISK_2014, AGE_2014, lINCOME_2014, zINCOME_2014,...
    MOM_HGC, DAD_HGC, AFQT_2006, HISPANIC, BLACK, FEMALE, AGE_14, ...
    INTERVIEW_1993, INTERVIEW_2002, INTERVIEW_2004, INTERVIEW_2006, INTERVIEW_2010, INTERVIEW_2012, INTERVIEW_2014] = ...
textread('../Input/MATLAB_INPUT1.txt','%u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u', -1, 'delimiter', '\t', 'emptyvalue', 0);
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('textread')" style="font-weight:bold">textread</a>
File not found.
} 
[ID, INCOME_1993, INTERVIEW_MONTH_1993, WKS_WORKED_SPS_1993, WKS_WORKED_1993, ...
    EAST_1993, SOUTH_1993, WEST_1993, MARRIED_1993, OTHER_1993, HS_1993, COLLEGE_1993, RISK_1993, AGE_1993, lINCOME_1993, zINCOME_1993, ...
    INCOME_2002, INTERVIEW_MONTH_2002, WKS_WORKED_SPS_2002, WKS_WORKED_2002, ...
    EAST_2002, SOUTH_2002, WEST_2002, MARRIED_2002, OTHER_2002, HS_2002, COLLEGE_2002, RISK_2002, AGE_2002, lINCOME_2002, zINCOME_2002,...
    INCOME_2004, INTERVIEW_MONTH_2004, WKS_WORKED_SPS_2004, WKS_WORKED_2004, ...
    EAST_2004, SOUTH_2004, WEST_2004, MARRIED_2004, OTHER_2004, HS_2004, COLLEGE_2004, RISK_2004, AGE_2004, lINCOME_2004, zINCOME_2004,...
    INCOME_2006, INTERVIEW_MONTH_2006, WKS_WORKED_SPS_2006, WKS_WORKED_2006, ...
    EAST_2006, SOUTH_2006, WEST_2006, MARRIED_2006, OTHER_2006, HS_2006, COLLEGE_2006, RISK_2006, AGE_2006, lINCOME_2006, zINCOME_2006,...
    INCOME_2010, INTERVIEW_MONTH_2010, WKS_WORKED_SPS_2010, WKS_WORKED_2010, ...
    EAST_2010, SOUTH_2010, WEST_2010, MARRIED_2010, OTHER_2010, HS_2010, COLLEGE_2010, RISK_2010, AGE_2010, lINCOME_2010, zINCOME_2010,...
    INCOME_2012, INTERVIEW_MONTH_2012, WKS_WORKED_SPS_2012, WKS_WORKED_2012, ...
    EAST_2012, SOUTH_2012, WEST_2012, MARRIED_2012, OTHER_2012, HS_2012, COLLEGE_2012, RISK_2012, AGE_2012, lINCOME_2012, zINCOME_2012,...
    INCOME_2014, INTERVIEW_MONTH_2014, WKS_WORKED_SPS_2014, WKS_WORKED_2014, ...
    EAST_2014, SOUTH_2014, WEST_2014, MARRIED_2014, OTHER_2014, HS_2014, COLLEGE_2014, RISK_2014, AGE_2014, lINCOME_2014, zINCOME_2014,...
    MOM_HGC, DAD_HGC, AFQT_2006, HISPANIC, BLACK, FEMALE, AGE_14, ...
    INTERVIEW_1993, INTERVIEW_2002, INTERVIEW_2004, INTERVIEW_2006, INTERVIEW_2010, INTERVIEW_2012, INTERVIEW_2014] = ...
textread('../Input/MATLAB_INPUT1.txt','%u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u', -1, 'delimiter', '\t', 'emptyvalue', 0);
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('dataread')" style="font-weight:bold">dataread</a>
Number of outputs must match the number of unskipped
input fields.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('textread', 'C:\Program Files\MATLAB\R2022a\toolbox\matlab\iofun\textread.m', 124)" style="font-weight:bold">textread</a> (<a href="matlab: opentoline('C:\Program Files\MATLAB\R2022a\toolbox\matlab\iofun\textread.m',124,0)">line 124</a>)
[varargout{1:nlhs}]=dataread('file',varargin{:}); %#ok<REMFF1>
} 
[ID, INCOME_1993, INTERVIEW_MONTH_1993, WKS_WORKED_SPS_1993, WKS_WORKED_1993, ...
    EAST_1993, SOUTH_1993, WEST_1993, MARRIED_1993, OTHER_1993, HS_1993, COLLEGE_1993, RISK_1993, AGE_1993, lINCOME_1993, zINCOME_1993, ...
    INCOME_2002, INTERVIEW_MONTH_2002, WKS_WORKED_SPS_2002, WKS_WORKED_2002, ...
    EAST_2002, SOUTH_2002, WEST_2002, MARRIED_2002, OTHER_2002, HS_2002, COLLEGE_2002, RISK_2002, AGE_2002, lINCOME_2002, zINCOME_2002,...
    INCOME_2004, INTERVIEW_MONTH_2004, WKS_WORKED_SPS_2004, WKS_WORKED_2004, ...
    EAST_2004, SOUTH_2004, WEST_2004, MARRIED_2004, OTHER_2004, HS_2004, COLLEGE_2004, RISK_2004, AGE_2004, lINCOME_2004, zINCOME_2004,...
    INCOME_2006, INTERVIEW_MONTH_2006, WKS_WORKED_SPS_2006, WKS_WORKED_2006, ...
    EAST_2006, SOUTH_2006, WEST_2006, MARRIED_2006, OTHER_2006, HS_2006, COLLEGE_2006, RISK_2006, AGE_2006, lINCOME_2006, zINCOME_2006,...
    INCOME_2010, INTERVIEW_MONTH_2010, WKS_WORKED_SPS_2010, WKS_WORKED_2010, ...
    EAST_2010, SOUTH_2010, WEST_2010, MARRIED_2010, OTHER_2010, HS_2010, COLLEGE_2010, RISK_2010, AGE_2010, lINCOME_2010, zINCOME_2010,...
    INCOME_2012, INTERVIEW_MONTH_2012, WKS_WORKED_SPS_2012, WKS_WORKED_2012, ...
    EAST_2012, SOUTH_2012, WEST_2012, MARRIED_2012, OTHER_2012, HS_2012, COLLEGE_2012, RISK_2012, AGE_2012, lINCOME_2012, zINCOME_2012,...
    INCOME_2014, INTERVIEW_MONTH_2014, WKS_WORKED_SPS_2014, WKS_WORKED_2014, ...
    EAST_2014, SOUTH_2014, WEST_2014, MARRIED_2014, OTHER_2014, HS_2014, COLLEGE_2014, RISK_2014, AGE_2014, lINCOME_2014, zINCOME_2014,...
    MOM_HGC, DAD_HGC, AFQT_2006, HISPANIC, BLACK, FEMALE, AGE_14, ...
    INTERVIEW_1993, INTERVIEW_2002, INTERVIEW_2004, INTERVIEW_2006, INTERVIEW_2010, INTERVIEW_2012, INTERVIEW_2014] = ...
textread('../Input/MATLAB_INPUT1.txt','%u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u', -1, 'delimiter', '\t', 'emptyvalue', 0);
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('dataread')" style="font-weight:bold">dataread</a>
Trouble reading unsigned integer from file (row 1,
field 15) ==>

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('textread', 'C:\Program Files\MATLAB\R2022a\toolbox\matlab\iofun\textread.m', 124)" style="font-weight:bold">textread</a> (<a href="matlab: opentoline('C:\Program Files\MATLAB\R2022a\toolbox\matlab\iofun\textread.m',124,0)">line 124</a>)
[varargout{1:nlhs}]=dataread('file',varargin{:}); %#ok<REMFF1>
} 
clear all;
[ID, INCOME_1993, INTERVIEW_MONTH_1993, WKS_WORKED_SPS_1993, WKS_WORKED_1993, ...
    EAST_1993, SOUTH_1993, WEST_1993, MARRIED_1993, OTHER_1993, HS_1993, COLLEGE_1993, RISK_1993, AGE_1993, ...
    INCOME_2002, INTERVIEW_MONTH_2002, WKS_WORKED_SPS_2002, WKS_WORKED_2002, ...
    EAST_2002, SOUTH_2002, WEST_2002, MARRIED_2002, OTHER_2002, HS_2002, COLLEGE_2002, RISK_2002, AGE_2002, ...
    INCOME_2004, INTERVIEW_MONTH_2004, WKS_WORKED_SPS_2004, WKS_WORKED_2004, ...
    EAST_2004, SOUTH_2004, WEST_2004, MARRIED_2004, OTHER_2004, HS_2004, COLLEGE_2004, RISK_2004, AGE_2004, ...
    INCOME_2006, INTERVIEW_MONTH_2006, WKS_WORKED_SPS_2006, WKS_WORKED_2006, ...
    EAST_2006, SOUTH_2006, WEST_2006, MARRIED_2006, OTHER_2006, HS_2006, COLLEGE_2006, RISK_2006, AGE_2006, ...
    INCOME_2010, INTERVIEW_MONTH_2010, WKS_WORKED_SPS_2010, WKS_WORKED_2010, ...
    EAST_2010, SOUTH_2010, WEST_2010, MARRIED_2010, OTHER_2010, HS_2010, COLLEGE_2010, RISK_2010, AGE_2010, ...
    INCOME_2012, INTERVIEW_MONTH_2012, WKS_WORKED_SPS_2012, WKS_WORKED_2012, ...
    EAST_2012, SOUTH_2012, WEST_2012, MARRIED_2012, OTHER_2012, HS_2012, COLLEGE_2012, RISK_2012, AGE_2012, ...
    INCOME_2014, INTERVIEW_MONTH_2014, WKS_WORKED_SPS_2014, WKS_WORKED_2014, ...
    EAST_2014, SOUTH_2014, WEST_2014, MARRIED_2014, OTHER_2014, HS_2014, COLLEGE_2014, RISK_2014, AGE_2014, ...
    MOM_HGC, DAD_HGC, AFQT_2006, HISPANIC, BLACK, FEMALE, AGE_14, ...
    INTERVIEW_1993, INTERVIEW_2002, INTERVIEW_2004, INTERVIEW_2006, INTERVIEW_2010, INTERVIEW_2012, INTERVIEW_2014] = ...
textread('../Input/MATLAB_INPUT.txt','%u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u', -1, 'delimiter', '\t', 'emptyvalue', 0);

N = size(ID,1);

lINCOME_1993 = log(INCOME_1993); lINCOME_2002 = log(INCOME_2002); lINCOME_2004 = log(INCOME_2004); lINCOME_2006 = log(INCOME_2006); lINCOME_2010 = log(INCOME_2010); lINCOME_2012 = log(INCOME_2012); lINCOME_2014 = log(INCOME_2014); 
zINCOME_1993 = INCOME_1993(:) == 0; zINCOME_2002 = INCOME_2002(:) == 0; zINCOME_2004 = INCOME_2004(:) == 0; zINCOME_2006 = INCOME_2006(:) == 0; zINCOME_2010 = INCOME_2010(:) == 0; zINCOME_2012 = INCOME_2012(:) == 0; zINCOME_2014 = INCOME_2014(:) == 0;  
lINCOME_1993(zINCOME_1993 == 1) = 0; 
lINCOME_1993(zINCOME_1993 == 1) = 0; lINCOME_2002(zINCOME_2002 == 1) = 0; lINCOME_2004(zINCOME_2004 == 1) = 0; lINCOME_2006(zINCOME_2006 == 1) = 0; lINCOME_2010(zINCOME_2010 == 1) = 0; lINCOME_2012(zINCOME_2012 == 1) = 0; lINCOME_2014(zINCOME_2014 == 1) = 0;
[amonth, ayear, ICS, URATE] = textread('../Input/AGGREGATE_MACRO.txt','%u %u %f %f');  

%% Create Measures of Aggregate Conditions in Interview Month %%
% ICS stands for Index of Consumer Sentiment 
% ICS and unemployment rate are used as controll for aggregate
% macroeconomic conditions that might effect holding of financial assets

ICS_1993 = zeros(N,1); ICS_2002 = zeros(N,1); ICS_2004 = zeros(N,1); ICS_2006 = zeros(N,1); ICS_2010 = zeros(N,1); ICS_2012 = zeros(N,1); ICS_2014 = zeros(N,1);
URATE_1993 = zeros(N,1); URATE_2002 = zeros(N,1); URATE_2004 = zeros(N,1); URATE_2006 = zeros(N,1); URATE_2010 = zeros(N,1); URATE_2012 = zeros(N,1); URATE_2014 = zeros(N,1);

%% 1993 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_1993 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 1993 & amonth == mn);
        ICS_1993(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_1993(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end   

%% 2002 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2002 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2002 & amonth == mn);
        ICS_2002(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2002(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2004 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2004 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2004 & amonth == mn);
        ICS_2004(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2004(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2006 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2006 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2006 & amonth == mn);
        ICS_2006(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2006(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2010 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2010 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2010 & amonth == mn);
        ICS_2010(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2010(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2012 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2012 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2012 & amonth == mn);
        ICS_2012(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2012(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2014 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2014 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2014 & amonth == mn);
        ICS_2014(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2014(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% Variable Matrices for Baseline Estimation %%    
X93 = zeros(N,13); X02 = zeros(N,13); X04 = zeros(N,13); X06 = zeros(N,13); X10 = zeros(N,13); X12 = zeros(N,13); X14 = zeros(N,13);

ii = find(INTERVIEW_1993 > 0);
X93(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_1993(ii), COLLEGE_1993(ii), AGE_1993(ii), ...
     lINCOME_1993(ii), zINCOME_1993(ii), WKS_WORKED_1993(ii), WKS_WORKED_SPS_1993(ii), URATE_1993(ii), ICS_1993(ii)];  

ii = find(INTERVIEW_2002 > 0);
X02(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2002(ii), COLLEGE_2002(ii), AGE_2002(ii), ...
    lINCOME_2002(ii), zINCOME_2002(ii), WKS_WORKED_2002(ii), WKS_WORKED_SPS_2002(ii), URATE_2002(ii), ICS_2002(ii)];  

ii = find(INTERVIEW_2004 > 0);
X04(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2004(ii), COLLEGE_2004(ii), AGE_2004(ii), ...
    lINCOME_2004(ii), zINCOME_2004(ii), WKS_WORKED_2004(ii), WKS_WORKED_SPS_2004(ii), URATE_2004(ii), ICS_2004(ii)];

ii = find(INTERVIEW_2006 > 0);
X06(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2006(ii), COLLEGE_2006(ii), AGE_2006(ii), ...
    lINCOME_2006(ii), zINCOME_2006(ii), WKS_WORKED_2006(ii), WKS_WORKED_SPS_2006(ii), URATE_2006(ii), ICS_2006(ii)]; 

ii = find(INTERVIEW_2010 > 0);
X10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2010(ii), COLLEGE_2010(ii), AGE_2010(ii), ...
    lINCOME_2010(ii), zINCOME_2010(ii), WKS_WORKED_2010(ii), WKS_WORKED_SPS_2010(ii), URATE_2010(ii), ICS_2010(ii)]; 

ii = find(INTERVIEW_2012 > 0);
X12(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2012(ii), COLLEGE_2012(ii), AGE_2012(ii), ...
    lINCOME_2012(ii), zINCOME_2012(ii), WKS_WORKED_2012(ii), WKS_WORKED_SPS_2012(ii), URATE_2012(ii), ICS_2012(ii)]; 

ii = find(INTERVIEW_2014 > 0);
X14(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2014(ii), COLLEGE_2014(ii), AGE_2014(ii), ...
    lINCOME_2014(ii), zINCOME_2014(ii), WKS_WORKED_2014(ii), WKS_WORKED_SPS_2014(ii), URATE_2014(ii), ICS_2014(ii)];  


X93 = sparse(X93); X02 = sparse(X02); X04 = sparse(X04); X06 = sparse(X06); X10 = sparse(X10); X12 = sparse(X12); X14 = sparse(X14);

%% Variable Matrices for Sampling Sensitivity Check %%
W93 = zeros(N,15); W02 = zeros(N,15); W04 = zeros(N,15); W06 = zeros(N,15); W10 = zeros(N,15); W12 = zeros(N,15); W14 = zeros(N,15);

ii = find(INTERVIEW_1993 > 0);
    W93(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_1993(ii), SOUTH_1993(ii), WEST_1993(ii), ...
        MARRIED_1993(ii), OTHER_1993(ii), AGE_1993(ii), URATE_1993(ii), ICS_1993(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];  

ii = find(INTERVIEW_2002 > 0);
    W02(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2002(ii), SOUTH_2002(ii), WEST_2002(ii), ...
        MARRIED_2002(ii), OTHER_2002(ii), AGE_2002(ii), URATE_2002(ii), ICS_2002(ii)];     
{Unable to perform assignment because the size of the
left side is 7485-by-15 and the size of the right
side is 7485-by-11.
} 
clear all;

delete('../Output/ImputeRisk.out')
[Warning: File not found or permission denied] 
diary('../Output/ImputeRisk.out');

disp('Output from ImputeRisk.m - August 21 2023');
Output from ImputeRisk.m - August 21 2023
disp('  ');
  

%% Input NLSY79 data %%
% input all variables including indicator dummy (instead of categorical
% variable)

[ID, INCOME_1993, INTERVIEW_MONTH_1993, WKS_WORKED_SPS_1993, WKS_WORKED_1993, ...
    EAST_1993, SOUTH_1993, WEST_1993, MARRIED_1993, OTHER_1993, HS_1993, COLLEGE_1993, RISK_1993, AGE_1993, ...
    INCOME_2002, INTERVIEW_MONTH_2002, WKS_WORKED_SPS_2002, WKS_WORKED_2002, ...
    EAST_2002, SOUTH_2002, WEST_2002, MARRIED_2002, OTHER_2002, HS_2002, COLLEGE_2002, RISK_2002, AGE_2002, ...
    INCOME_2004, INTERVIEW_MONTH_2004, WKS_WORKED_SPS_2004, WKS_WORKED_2004, ...
    EAST_2004, SOUTH_2004, WEST_2004, MARRIED_2004, OTHER_2004, HS_2004, COLLEGE_2004, RISK_2004, AGE_2004, ...
    INCOME_2006, INTERVIEW_MONTH_2006, WKS_WORKED_SPS_2006, WKS_WORKED_2006, ...
    EAST_2006, SOUTH_2006, WEST_2006, MARRIED_2006, OTHER_2006, HS_2006, COLLEGE_2006, RISK_2006, AGE_2006, ...
    INCOME_2010, INTERVIEW_MONTH_2010, WKS_WORKED_SPS_2010, WKS_WORKED_2010, ...
    EAST_2010, SOUTH_2010, WEST_2010, MARRIED_2010, OTHER_2010, HS_2010, COLLEGE_2010, RISK_2010, AGE_2010, ...
    INCOME_2012, INTERVIEW_MONTH_2012, WKS_WORKED_SPS_2012, WKS_WORKED_2012, ...
    EAST_2012, SOUTH_2012, WEST_2012, MARRIED_2012, OTHER_2012, HS_2012, COLLEGE_2012, RISK_2012, AGE_2012, ...
    INCOME_2014, INTERVIEW_MONTH_2014, WKS_WORKED_SPS_2014, WKS_WORKED_2014, ...
    EAST_2014, SOUTH_2014, WEST_2014, MARRIED_2014, OTHER_2014, HS_2014, COLLEGE_2014, RISK_2014, AGE_2014, ...
    MOM_HGC, DAD_HGC, AFQT_2006, HISPANIC, BLACK, FEMALE, AGE_14, ...
    INTERVIEW_1993, INTERVIEW_2002, INTERVIEW_2004, INTERVIEW_2006, INTERVIEW_2010, INTERVIEW_2012, INTERVIEW_2014] = ...
textread('../Input/MATLAB_INPUT.txt','%u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u', -1, 'delimiter', '\t', 'emptyvalue', 0);

N = size(ID,1);

lINCOME_1993 = log(INCOME_1993); lINCOME_2002 = log(INCOME_2002); lINCOME_2004 = log(INCOME_2004); lINCOME_2006 = log(INCOME_2006); lINCOME_2010 = log(INCOME_2010); lINCOME_2012 = log(INCOME_2012); lINCOME_2014 = log(INCOME_2014); 
zINCOME_1993 = INCOME_1993(:) == 0; zINCOME_2002 = INCOME_2002(:) == 0; zINCOME_2004 = INCOME_2004(:) == 0; zINCOME_2006 = INCOME_2006(:) == 0; zINCOME_2010 = INCOME_2010(:) == 0; zINCOME_2012 = INCOME_2012(:) == 0; zINCOME_2014 = INCOME_2014(:) == 0;  
lINCOME_1993(zINCOME_1993 == 1) = 0; lINCOME_2002(zINCOME_2002 == 1) = 0; lINCOME_2004(zINCOME_2004 == 1) = 0; lINCOME_2006(zINCOME_2006 == 1) = 0; lINCOME_2010(zINCOME_2010 == 1) = 0; lINCOME_2012(zINCOME_2012 == 1) = 0; lINCOME_2014(zINCOME_2014 == 1) = 0;

%% Input Aggregate Data %%
[amonth, ayear, ICS, URATE] = textread('../Input/AGGREGATE_MACRO.txt','%u %u %f %f');  

%% Create Measures of Aggregate Conditions in Interview Month %%
% ICS stands for Index of Consumer Sentiment 
% ICS and unemployment rate are used as controll for aggregate
% macroeconomic conditions that might effect holding of financial assets

ICS_1993 = zeros(N,1); ICS_2002 = zeros(N,1); ICS_2004 = zeros(N,1); ICS_2006 = zeros(N,1); ICS_2010 = zeros(N,1); ICS_2012 = zeros(N,1); ICS_2014 = zeros(N,1);
URATE_1993 = zeros(N,1); URATE_2002 = zeros(N,1); URATE_2004 = zeros(N,1); URATE_2006 = zeros(N,1); URATE_2010 = zeros(N,1); URATE_2012 = zeros(N,1); URATE_2014 = zeros(N,1);

%% 1993 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_1993 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 1993 & amonth == mn);
        ICS_1993(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_1993(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end   

%% 2002 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2002 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2002 & amonth == mn);
        ICS_2002(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2002(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2004 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2004 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2004 & amonth == mn);
        ICS_2004(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2004(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2006 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2006 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2006 & amonth == mn);
        ICS_2006(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2006(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2010 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2010 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2010 & amonth == mn);
        ICS_2010(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2010(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2012 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2012 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2012 & amonth == mn);
        ICS_2012(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2012(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2014 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2014 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2014 & amonth == mn);
        ICS_2014(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2014(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% Variable Matrices for Baseline Estimation %%    
X93 = zeros(N,13); X02 = zeros(N,13); X04 = zeros(N,13); X06 = zeros(N,13); X10 = zeros(N,13); X12 = zeros(N,13); X14 = zeros(N,13);

ii = find(INTERVIEW_1993 > 0);
X93(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_1993(ii), COLLEGE_1993(ii), AGE_1993(ii), ...
     lINCOME_1993(ii), zINCOME_1993(ii), WKS_WORKED_1993(ii), WKS_WORKED_SPS_1993(ii), URATE_1993(ii), ICS_1993(ii)];  

ii = find(INTERVIEW_2002 > 0);
X02(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2002(ii), COLLEGE_2002(ii), AGE_2002(ii), ...
    lINCOME_2002(ii), zINCOME_2002(ii), WKS_WORKED_2002(ii), WKS_WORKED_SPS_2002(ii), URATE_2002(ii), ICS_2002(ii)];  

ii = find(INTERVIEW_2004 > 0);
X04(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2004(ii), COLLEGE_2004(ii), AGE_2004(ii), ...
    lINCOME_2004(ii), zINCOME_2004(ii), WKS_WORKED_2004(ii), WKS_WORKED_SPS_2004(ii), URATE_2004(ii), ICS_2004(ii)];

ii = find(INTERVIEW_2006 > 0);
X06(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2006(ii), COLLEGE_2006(ii), AGE_2006(ii), ...
    lINCOME_2006(ii), zINCOME_2006(ii), WKS_WORKED_2006(ii), WKS_WORKED_SPS_2006(ii), URATE_2006(ii), ICS_2006(ii)]; 

ii = find(INTERVIEW_2010 > 0);
X10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2010(ii), COLLEGE_2010(ii), AGE_2010(ii), ...
    lINCOME_2010(ii), zINCOME_2010(ii), WKS_WORKED_2010(ii), WKS_WORKED_SPS_2010(ii), URATE_2010(ii), ICS_2010(ii)]; 

ii = find(INTERVIEW_2012 > 0);
X12(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2012(ii), COLLEGE_2012(ii), AGE_2012(ii), ...
    lINCOME_2012(ii), zINCOME_2012(ii), WKS_WORKED_2012(ii), WKS_WORKED_SPS_2012(ii), URATE_2012(ii), ICS_2012(ii)]; 

ii = find(INTERVIEW_2014 > 0);
X14(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2014(ii), COLLEGE_2014(ii), AGE_2014(ii), ...
    lINCOME_2014(ii), zINCOME_2014(ii), WKS_WORKED_2014(ii), WKS_WORKED_SPS_2014(ii), URATE_2014(ii), ICS_2014(ii)];  


X93 = sparse(X93); X02 = sparse(X02); X04 = sparse(X04); X06 = sparse(X06); X10 = sparse(X10); X12 = sparse(X12); X14 = sparse(X14);

%% Variable Matrices for Sampling Sensitivity Check %%
W93 = zeros(N,15); W02 = zeros(N,15); W04 = zeros(N,15); W06 = zeros(N,15); W10 = zeros(N,15); W12 = zeros(N,15); W14 = zeros(N,15);

ii = find(INTERVIEW_1993 > 0);
    W93(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_1993(ii), SOUTH_1993(ii), WEST_1993(ii), ...
        MARRIED_1993(ii), OTHER_1993(ii), AGE_1993(ii), URATE_1993(ii), ICS_1993(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];  

ii = find(INTERVIEW_2002 > 0);
    W02(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2002(ii), SOUTH_2002(ii), WEST_2002(ii), ...
        MARRIED_2002(ii), OTHER_2002(ii), AGE_2002(ii), URATE_2002(ii), ICS_2002(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];     

ii = find(INTERVIEW_2004 > 0);
    W04(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2004(ii), SOUTH_2004(ii), WEST_2004(ii), ...
        MARRIED_2004(ii), OTHER_2004(ii), AGE_2004(ii), URATE_2004(ii), ICS_2004(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];      

ii = find(INTERVIEW_2006 > 0);
    W06(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2006(ii), SOUTH_2006(ii), WEST_2006(ii), ...
        MARRIED_2006(ii), OTHER_2006(ii), AGE_2006(ii), URATE_2006(ii), ICS_2006(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];   

ii = find(INTERVIEW_2010 > 0);
    W10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2010(ii), SOUTH_2010(ii), WEST_2010(ii), ...
        MARRIED_2010(ii), OTHER_2010(ii), AGE_2010(ii), URATE_2010(ii), ICS_2010(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];     

ii = find(INTERVIEW_2012 > 0);
    W10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2012(ii), SOUTH_2012(ii), WEST_2012(ii), ...
        MARRIED_2012(ii), OTHER_2012(ii), AGE_2012(ii), URATE_2012(ii), ICS_2012(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];  

ii = find(INTERVIEW_2014 > 0);
    W10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2014(ii), SOUTH_2014(ii), WEST_2014(ii), ...
    MARRIED_2014(ii), OTHER_2014(ii), AGE_2014(ii), URATE_2014(ii), ICS_2014(ii), MOM_HGC(ii), DAD_HGC(ii), AGE_14(ii), AFQT_2006(ii)];  

W93 = sparse(W93); W02 = sparse(W02); W04 = sparse(W04); W06 = sparse(W06); W10 = sparse(W10); W12 = sparse(W12); W14 = sparse(W14);

%% Variable Matrices for Sampling Sensitivity Check (Plus Second-Step Covariates) %%

XW93 = zeros(N,22); XW02 = zeros(N,22); XW04 = zeros(N,22); XW06 = zeros(N,22); XW10 = zeros(N,22); XW12 = zeros(N,22); XW14 = zeros(N,22);

ii = find(INTERVIEW_1993 > 0);
XW93(ii,:) = [W93(ii,:), FEMALE(ii), HS_1993(ii), COLLEGE_1993(ii), lINCOME_1993(ii), ... 
    zINCOME_1993(ii), WKS_WORKED_1993(ii), WKS_WORKED_SPS_1993(ii)];  

ii = find(INTERVIEW_2002 > 0);
XW02(ii,:) = [W02(ii,:), FEMALE(ii), HS_2002(ii), COLLEGE_2002(ii), lINCOME_2002(ii), ... 
    zINCOME_2002(ii), WKS_WORKED_2002(ii), WKS_WORKED_SPS_2002(ii)];  

ii = find(INTERVIEW_2004 > 0);
XW04(ii,:) = [W04(ii,:), FEMALE(ii), HS_2004(ii), COLLEGE_2004(ii), lINCOME_2004(ii), ... 
    zINCOME_2004(ii), WKS_WORKED_2004(ii), WKS_WORKED_SPS_2004(ii)];  

ii = find(INTERVIEW_2006 > 0);
XW06(ii,:) = [W06(ii,:), FEMALE(ii), HS_2006(ii), COLLEGE_2006(ii), lINCOME_2006(ii), ... 
    zINCOME_2006(ii), WKS_WORKED_2006(ii), WKS_WORKED_SPS_2006(ii)]; 

ii = find(INTERVIEW_2010 > 0);
XW10(ii,:) = [W10(ii,:), FEMALE(ii), HS_2010(ii), COLLEGE_2010(ii), lINCOME_2010(ii), ... 
    zINCOME_2010(ii), WKS_WORKED_2010(ii), WKS_WORKED_SPS_2010(ii)];   

ii = find(INTERVIEW_2012 > 0);
XW12(ii,:) = [W12(ii,:), FEMALE(ii), HS_2012(ii), COLLEGE_2012(ii), lINCOME_2012(ii), ... 
    zINCOME_2012(ii), WKS_WORKED_2012(ii), WKS_WORKED_SPS_2012(ii)];   

ii = find(INTERVIEW_2014 > 0);
XW14(ii,:) = [W14(ii,:), FEMALE(ii), HS_2014(ii), COLLEGE_2014(ii), lINCOME_2014(ii), ... 
    zINCOME_2014(ii), WKS_WORKED_2014(ii), WKS_WORKED_SPS_2014(ii)];   


XW93 = sparse(XW93); XW02 = sparse(XW02); XW04 = sparse(XW04); XW06 = sparse(XW06); XW10 = sparse(XW10); XW12 = sparse(XW12); XW14 = sparse(XW14);

%% Save Matlab Data set %%
save ../Output/MATLAB_sample ID X* W* N HS* COLLEGE* FEMALE* RISK* lINCOME* zINCOME* BLACK HISPANIC WKS* MARRIED* OTHER* AGE*
diary off;
