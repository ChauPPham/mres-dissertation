Model 11
Array indices must be positive integers or logical
values.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('likelihood', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\likelihood.m', 68)" style="font-weight:bold">likelihood</a> (<a href="matlab: opentoline('C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\likelihood.m',68,0)">line 68</a>)
                Li93(i,k) =
                norm_cdf((cpt_old(c93(i)+1)-muX93(i)-xU(j)-xKo(k))./sigmae93(i))
                - ...

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('EstimateRisk', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m', 172)" style="font-weight:bold">EstimateRisk</a> (<a href="matlab: opentoline('C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m',172,0)">line 172</a>)
        lik = likelihood(b,c93,c02,c04,c06,c10,
        c12,c14,X93,X02,X04,X06,X10,X12,X14);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ImputeRisk', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\ImputeRisk.m', 252)" style="font-weight:bold">ImputeRisk</a> (<a href="matlab: opentoline('C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\ImputeRisk.m',252,0)">line 252</a>)
EstimateRisk(RISK_1993, RISK_2002, RISK_2004,
RISK_2006, RISK_2010, RISK_2012,
RISK_2014,[X93(:,1),ones(N,1)],[X02(:,1),ones(N,1)],[X04(:,1),ones(N,1)],[X06(:,1),ones(N,1)],[X10(:,1),ones(N,1)],[X12(:,1),ones(N,1)],[X14(:,1),ones(N,1)]);

clear all
%% Input NLSY79 data %%
% input all variables including indicator dummy (instead of categorical
% variable)

[ID, INCOME_1993, INTERVIEW_MONTH_1993, WKS_WORKED_SPS_1993, WKS_WORKED_1993, ...
    EAST_1993, SOUTH_1993, WEST_1993, MARRIED_1993, OTHER_1993, HS_1993, COLLEGE_1993, RISK_1993, AGE_1993, ...
    INCOME_2002, INTERVIEW_MONTH_2002, WKS_WORKED_SPS_2002, WKS_WORKED_2002, ...
    EAST_2002, SOUTH_2002, WEST_2002, MARRIED_2002, OTHER_2002, HS_2002, COLLEGE_2002, RISK_2002, AGE_2002, ...
    INCOME_2004, INTERVIEW_MONTH_2004, WKS_WORKED_SPS_2004, WKS_WORKED_2004, ...
    EAST_2004, SOUTH_2004, WEST_2004, MARRIED_2004, OTHER_2004, HS_2004, COLLEGE_2004, RISK_2004, AGE_2004, ...
    INCOME_2006, INTERVIEW_MONTH_2006, WKS_WORKED_SPS_2006, WKS_WORKED_2006, ...
    EAST_2006, SOUTH_2006, WEST_2006, MARRIED_2006, OTHER_2006, HS_2006, COLLEGE_2006, RISK_2006, AGE_2006, ...
    INCOME_2010, INTERVIEW_MONTH_2010, WKS_WORKED_SPS_2010, WKS_WORKED_2010, ...
    EAST_2010, SOUTH_2010, WEST_2010, MARRIED_2010, OTHER_2010, HS_2010, COLLEGE_2010, RISK_2010, AGE_2010, ...
    INCOME_2012, INTERVIEW_MONTH_2012, WKS_WORKED_SPS_2012, WKS_WORKED_2012, ...
    EAST_2012, SOUTH_2012, WEST_2012, MARRIED_2012, OTHER_2012, HS_2012, COLLEGE_2012, RISK_2012, AGE_2012, ...
    INCOME_2014, INTERVIEW_MONTH_2014, WKS_WORKED_SPS_2014, WKS_WORKED_2014, ...
    EAST_2014, SOUTH_2014, WEST_2014, MARRIED_2014, OTHER_2014, HS_2014, COLLEGE_2014, RISK_2014, AGE_2014, ...
    MOM_HGC, DAD_HGC, AFQT_2006, HISPANIC, BLACK, FEMALE, AGE_14, ...
    INTERVIEW_1993, INTERVIEW_2002, INTERVIEW_2004, INTERVIEW_2006, INTERVIEW_2010, INTERVIEW_2012, INTERVIEW_2014] = ...
textread('../Input/MATLAB_INPUT.txt','%u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u', -1, 'delimiter', '\t', 'emptyvalue', missing);
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('dataread')" style="font-weight:bold">dataread</a>
Empty Value must be a scalar double.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('textread', 'C:\Program Files\MATLAB\R2022a\toolbox\matlab\iofun\textread.m', 124)" style="font-weight:bold">textread</a> (<a href="matlab: opentoline('C:\Program Files\MATLAB\R2022a\toolbox\matlab\iofun\textread.m',124,0)">line 124</a>)
[varargout{1:nlhs}]=dataread('file',varargin{:}); %#ok<REMFF1>
} 
[ID, INCOME_1993, INTERVIEW_MONTH_1993, WKS_WORKED_SPS_1993, WKS_WORKED_1993, ...
    EAST_1993, SOUTH_1993, WEST_1993, MARRIED_1993, OTHER_1993, HS_1993, COLLEGE_1993, RISK_1993, AGE_1993, ...
    INCOME_2002, INTERVIEW_MONTH_2002, WKS_WORKED_SPS_2002, WKS_WORKED_2002, ...
    EAST_2002, SOUTH_2002, WEST_2002, MARRIED_2002, OTHER_2002, HS_2002, COLLEGE_2002, RISK_2002, AGE_2002, ...
    INCOME_2004, INTERVIEW_MONTH_2004, WKS_WORKED_SPS_2004, WKS_WORKED_2004, ...
    EAST_2004, SOUTH_2004, WEST_2004, MARRIED_2004, OTHER_2004, HS_2004, COLLEGE_2004, RISK_2004, AGE_2004, ...
    INCOME_2006, INTERVIEW_MONTH_2006, WKS_WORKED_SPS_2006, WKS_WORKED_2006, ...
    EAST_2006, SOUTH_2006, WEST_2006, MARRIED_2006, OTHER_2006, HS_2006, COLLEGE_2006, RISK_2006, AGE_2006, ...
    INCOME_2010, INTERVIEW_MONTH_2010, WKS_WORKED_SPS_2010, WKS_WORKED_2010, ...
    EAST_2010, SOUTH_2010, WEST_2010, MARRIED_2010, OTHER_2010, HS_2010, COLLEGE_2010, RISK_2010, AGE_2010, ...
    INCOME_2012, INTERVIEW_MONTH_2012, WKS_WORKED_SPS_2012, WKS_WORKED_2012, ...
    EAST_2012, SOUTH_2012, WEST_2012, MARRIED_2012, OTHER_2012, HS_2012, COLLEGE_2012, RISK_2012, AGE_2012, ...
    INCOME_2014, INTERVIEW_MONTH_2014, WKS_WORKED_SPS_2014, WKS_WORKED_2014, ...
    EAST_2014, SOUTH_2014, WEST_2014, MARRIED_2014, OTHER_2014, HS_2014, COLLEGE_2014, RISK_2014, AGE_2014, ...
    MOM_HGC, DAD_HGC, AFQT_2006, HISPANIC, BLACK, FEMALE, AGE_14, ...
    INTERVIEW_1993, INTERVIEW_2002, INTERVIEW_2004, INTERVIEW_2006, INTERVIEW_2010, INTERVIEW_2012, INTERVIEW_2014] = ...
textread('../Input/MATLAB_INPUT.txt','%u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %f %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u %u', -1, 'delimiter', '\t', 'emptyvalue', NaN);
N = size(ID,1);

lINCOME_1993 = log(INCOME_1993); lINCOME_2002 = log(INCOME_2002); lINCOME_2004 = log(INCOME_2004); lINCOME_2006 = log(INCOME_2006); lINCOME_2010 = log(INCOME_2010); lINCOME_2012 = log(INCOME_2012); lINCOME_2014 = log(INCOME_2014); 
zINCOME_1993 = INCOME_1993(:) == 0; zINCOME_2002 = INCOME_2002(:) == 0; zINCOME_2004 = INCOME_2004(:) == 0; zINCOME_2006 = INCOME_2006(:) == 0; zINCOME_2010 = INCOME_2010(:) == 0; zINCOME_2012 = INCOME_2012(:) == 0; zINCOME_2014 = INCOME_2014(:) == 0;  

%% Input Aggregate Data %%
[amonth, ayear, ICS, URATE] = textread('../Input/AGGREGATE_MACRO.txt','%u %u %f %f');  

%% Create Measures of Aggregate Conditions in Interview Month %%
% ICS stands for Index of Consumer Sentiment 
% ICS and unemployment rate are used as controll for aggregate
% macroeconomic conditions that might effect holding of financial assets

ICS_1993 = zeros(N,1); ICS_2002 = zeros(N,1); ICS_2004 = zeros(N,1); ICS_2006 = zeros(N,1); ICS_2010 = zeros(N,1); ICS_2012 = zeros(N,1); ICS_2014 = zeros(N,1);
URATE_1993 = zeros(N,1); URATE_2002 = zeros(N,1); URATE_2004 = zeros(N,1); URATE_2006 = zeros(N,1); URATE_2010 = zeros(N,1); URATE_2012 = zeros(N,1); URATE_2014 = zeros(N,1);

%% 1993 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_1993 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 1993 & amonth == mn);
        ICS_1993(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_1993(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end   

%% 2002 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2002 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2002 & amonth == mn);
        ICS_2002(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2002(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2004 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2004 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2004 & amonth == mn);
        ICS_2004(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2004(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2006 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2006 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2006 & amonth == mn);
        ICS_2006(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2006(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2010 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2010 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2010 & amonth == mn);
        ICS_2010(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2010(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2012 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2012 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2012 & amonth == mn);
        ICS_2012(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2012(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% 2014 NLSY79
for mn = 1:12
ii = find(INTERVIEW_MONTH_2014 == mn);
    if size(ii,1) > 0 
        aa = find(ayear == 2014 & amonth == mn);
        ICS_2014(ii,1) = ICS(aa,1)/10; % Index of Consumer Sentiment / 10 in interview month
        URATE_2014(ii,1) = URATE(aa,1)*100; % Unemployment rate in interview month
    end
end

%% Variable Matrices for Baseline Estimation %%    
X93 = zeros(N,13); X02 = zeros(N,13); X04 = zeros(N,13); X06 = zeros(N,13); X10 = zeros(N,13); X12 = zeros(N,13); X14 = zeros(N,13);

ii = find(INTERVIEW_1993 > 0);
X93(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_1993(ii), COLLEGE_1993(ii), AGE_1993(ii), ...
     lINCOME_1993(ii), zINCOME_1993(ii), WKS_WORKED_1993(ii), WKS_WORKED_SPS_1993(ii), URATE_1993(ii), ICS_1993(ii)];  

ii = find(INTERVIEW_2002 > 0);
X02(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2002(ii), COLLEGE_2002(ii), AGE_2002(ii), ...
    lINCOME_2002(ii), zINCOME_2002(ii), WKS_WORKED_2002(ii), WKS_WORKED_SPS_2002(ii), URATE_2002(ii), ICS_2002(ii)];  

ii = find(INTERVIEW_2004 > 0);
X04(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2004(ii), COLLEGE_2004(ii), AGE_2004(ii), ...
    lINCOME_2004(ii), zINCOME_2004(ii), WKS_WORKED_2004(ii), WKS_WORKED_SPS_2004(ii), URATE_2004(ii), ICS_2004(ii)];

ii = find(INTERVIEW_2006 > 0);
X06(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2006(ii), COLLEGE_2006(ii), AGE_2006(ii), ...
    lINCOME_2006(ii), zINCOME_2006(ii), WKS_WORKED_2006(ii), WKS_WORKED_SPS_2006(ii), URATE_2006(ii), ICS_2006(ii)]; 

ii = find(INTERVIEW_2010 > 0);
X10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2010(ii), COLLEGE_2010(ii), AGE_2010(ii), ...
    lINCOME_2010(ii), zINCOME_2010(ii), WKS_WORKED_2010(ii), WKS_WORKED_SPS_2010(ii), URATE_2010(ii), ICS_2010(ii)]; 

ii = find(INTERVIEW_2012 > 0);
X12(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2012(ii), COLLEGE_2012(ii), AGE_2012(ii), ...
    lINCOME_2012(ii), zINCOME_2012(ii), WKS_WORKED_2012(ii), WKS_WORKED_SPS_2012(ii), URATE_2012(ii), ICS_2012(ii)]; 

ii = find(INTERVIEW_2014 > 0);
X14(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), FEMALE(ii), HS_2014(ii), COLLEGE_2014(ii), AGE_2014(ii), ...
    lINCOME_2014(ii), zINCOME_2014(ii), WKS_WORKED_2014(ii), WKS_WORKED_SPS_2014(ii), URATE_2014(ii), ICS_2014(ii)];  


X93 = sparse(X93); X02 = sparse(X02); X04 = sparse(X04); X06 = sparse(X06); X10 = sparse(X10); X12 = sparse(X12); X14 = sparse(X14);

%% Variable Matrices for Sampling Sensitivity Check %%
W93 = zeros(N,11); W02 = zeros(N,11); W04 = zeros(N,11); W06 = zeros(N,11); W10 = zeros(N,11); W12 = zeros(N,11); W14 = zeros(N,11);

ii = find(INTERVIEW_1993 > 0);
    W93(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_1993(ii), SOUTH_1993(ii), WEST_1993(ii), ...
        MARRIED_1993(ii), OTHER_1993(ii), AGE_1993(ii), URATE_1993(ii), ICS_1993(ii)];  

ii = find(INTERVIEW_2002 > 0);
    W02(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2002(ii), SOUTH_2002(ii), WEST_2002(ii), ...
        MARRIED_2002(ii), OTHER_2002(ii), AGE_2002(ii), URATE_2002(ii), ICS_2002(ii)];     

ii = find(INTERVIEW_2004 > 0);
    W04(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2004(ii), SOUTH_2004(ii), WEST_2004(ii), ...
        MARRIED_2004(ii), OTHER_2004(ii), AGE_2004(ii), URATE_2004(ii), ICS_2004(ii)];      

ii = find(INTERVIEW_2006 > 0);
    W06(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2006(ii), SOUTH_2006(ii), WEST_2006(ii), ...
        MARRIED_2006(ii), OTHER_2006(ii), AGE_2006(ii), URATE_2006(ii), ICS_2006(ii)];   

ii = find(INTERVIEW_2010 > 0);
    W10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2010(ii), SOUTH_2010(ii), WEST_2010(ii), ...
        MARRIED_2010(ii), OTHER_2010(ii), AGE_2010(ii), URATE_2010(ii), ICS_2010(ii)];     

ii = find(INTERVIEW_2012 > 0);
    W10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2012(ii), SOUTH_2012(ii), WEST_2012(ii), ...
        MARRIED_2012(ii), OTHER_2012(ii), AGE_2012(ii), URATE_2012(ii), ICS_2012(ii)];  

ii = find(INTERVIEW_2014 > 0);
    W10(ii,:) = [ones(size(ii)), BLACK(ii), HISPANIC(ii), EAST_2014(ii), SOUTH_2014(ii), WEST_2014(ii), ...
    MARRIED_2014(ii), OTHER_2014(ii), AGE_2014(ii), URATE_2014(ii), ICS_2014(ii)];  

W93 = sparse(W93); W02 = sparse(W02); W04 = sparse(W04); W06 = sparse(W06); W10 = sparse(W10); W12 = sparse(W12); W14 = sparse(W14);

%% Variable Matrices for Sampling Sensitivity Check (Plus Second-Step Covariates) %%

XW93 = zeros(N,18); XW02 = zeros(N,18); XW04 = zeros(N,18); XW06 = zeros(N,18); XW10 = zeros(N,18); XW12 = zeros(N,18); XW14 = zeros(N,18);

ii = find(INTERVIEW_1993 > 0);
XW93(ii,:) = [W93(ii,:), FEMALE(ii), HS_1993(ii), COLLEGE_1993(ii), lINCOME_1993(ii), ... 
    zINCOME_1993(ii), WKS_WORKED_1993(ii), WKS_WORKED_SPS_1993(ii)];  

ii = find(INTERVIEW_2002 > 0);
XW02(ii,:) = [W02(ii,:), FEMALE(ii), HS_2002(ii), COLLEGE_2002(ii), lINCOME_2002(ii), ... 
    zINCOME_2002(ii), WKS_WORKED_2002(ii), WKS_WORKED_SPS_2002(ii)];  

ii = find(INTERVIEW_2004 > 0);
XW04(ii,:) = [W04(ii,:), FEMALE(ii), HS_2004(ii), COLLEGE_2004(ii), lINCOME_2004(ii), ... 
    zINCOME_2004(ii), WKS_WORKED_2004(ii), WKS_WORKED_SPS_2004(ii)];  

ii = find(INTERVIEW_2006 > 0);
XW06(ii,:) = [W06(ii,:), FEMALE(ii), HS_2006(ii), COLLEGE_2006(ii), lINCOME_2006(ii), ... 
    zINCOME_2006(ii), WKS_WORKED_2006(ii), WKS_WORKED_SPS_2006(ii)]; 

ii = find(INTERVIEW_2010 > 0);
XW10(ii,:) = [W10(ii,:), FEMALE(ii), HS_2010(ii), COLLEGE_2010(ii), lINCOME_2010(ii), ... 
    zINCOME_2010(ii), WKS_WORKED_2010(ii), WKS_WORKED_SPS_2010(ii)];   

ii = find(INTERVIEW_2012 > 0);
XW12(ii,:) = [W12(ii,:), FEMALE(ii), HS_2012(ii), COLLEGE_2012(ii), lINCOME_2012(ii), ... 
    zINCOME_2012(ii), WKS_WORKED_2012(ii), WKS_WORKED_SPS_2012(ii)];   

ii = find(INTERVIEW_2014 > 0);
XW14(ii,:) = [W14(ii,:), FEMALE(ii), HS_2014(ii), COLLEGE_2014(ii), lINCOME_2014(ii), ... 
    zINCOME_2014(ii), WKS_WORKED_2014(ii), WKS_WORKED_SPS_2014(ii)];   


XW93 = sparse(XW93); XW02 = sparse(XW02); XW04 = sparse(XW04); XW06 = sparse(XW06); XW10 = sparse(XW10); XW12 = sparse(XW12); XW14 = sparse(XW14);

%% Save Matlab Data set %%
save ../Output/MATLAB_sample ID X* W* N HS* COLLEGE* FEMALE* RISK* lINCOME* zINCOME* BLACK HISPANIC WKS* MARRIED* OTHER* AGE*
diary off;
disp('Model 11')
Model 11
EstimateRisk(RISK_1993, RISK_2002, RISK_2004, RISK_2006, RISK_2010, RISK_2012, RISK_2014,[X93(:,1),ones(N,1)],[X02(:,1),ones(N,1)],[X04(:,1),ones(N,1)],[X06(:,1),ones(N,1)],[X10(:,1),ones(N,1)],[X12(:,1),ones(N,1)],[X14(:,1),ones(N,1)]);
[Warning: Matrix is close to singular or badly scaled.
Results may be inaccurate. RCOND =  9.050492e-18.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('EstimateRisk', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m', 176)" style="font-weight:bold">EstimateRisk</a> (<a href="matlab: opentoline('C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m',176,0)">line 176</a>)
] 
[Warning: Matrix is close to singular or badly scaled.
Results may be inaccurate. RCOND =  9.050492e-18.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('EstimateRisk', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m', 183)" style="font-weight:bold">EstimateRisk</a> (<a href="matlab: opentoline('C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m',183,0)">line 183</a>)
] 
Error at iteration 1 = 8.58e+04
22-Aug-2023 16:37:46
{Unrecognized function or variable 'mprint'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('EstimateRisk', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m', 190)" style="font-weight:bold">EstimateRisk</a> (<a href="matlab: opentoline('C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m',190,0)">line 190</a>)
        mprint([b,b./se,d],info)
} 
matlab.internal.language.introspective.errorDocCallback('EstimateRisk', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m', 190)
cutoof_new
{Unrecognized function or variable 'cutoof_new'.
} 
cutoff)new
 cutoff)new
       ↑
{Invalid expression. When calling a function or indexing
a variable, use parentheses. Otherwise, check for
mismatched delimiters.
} 
cutoff_new
{Unrecognized function or variable 'cutoff_new'.
} 
cpt_old
{Unrecognized function or variable 'cpt_old'.
} 
dfrac = 1 - [1/5,1/3,1/2]; %(1 - downside risk) old series 
dfrac_new = 1 - [0.05, 0.1, 0.15];   %(1 - downside risk) new series

cutoff_old = zeros(1,size(dfrac,2));
for j = 1:size(dfrac,2)
    gamma = 5; % Initial guess for coefficient of relative risk aversion;
    for it=1:maxit  % Newton Rootfinder;  
        [fval,fjac] = dutility_old(gamma,dfrac(1,j));
        gamma = gamma - fjac\fval; 
        if norm(fval) < tol, break, end 
    end
    cutoff_old(1,j) = gamma.^-1; % Risk tolerance (Inverse of Risk Aversion);
end
{Unrecognized function or variable 'maxit'.
} 
maxit = 200;
tol = 1.0e-6; 

%% Compute Risk Tolerance Cutoffs for Risk Categories %%
dfrac = 1 - [1/5,1/3,1/2]; %(1 - downside risk) old series 
dfrac_new = 1 - [0.05, 0.1, 0.15];   %(1 - downside risk) new series

cutoff_old = zeros(1,size(dfrac,2));
for j = 1:size(dfrac,2)
    gamma = 5; % Initial guess for coefficient of relative risk aversion;
    for it=1:maxit  % Newton Rootfinder;  
        [fval,fjac] = dutility_old(gamma,dfrac(1,j));
        gamma = gamma - fjac\fval; 
        if norm(fval) < tol, break, end 
    end
    cutoff_old(1,j) = gamma.^-1; % Risk tolerance (Inverse of Risk Aversion);
end
cpt_old = [-1.0e+77;log(cutoff_old)';1.0e+77]; % old bounds 

cutoff_new = zeros(1,size(dfrac_new,2));
for j = 1:size(dfrac_new,2)
    gamma = 5; % Initial guess for coefficient of relative risk aversion;
    for it=1:maxit  % Newton Rootfinder;  
        [fval,fjac] = dutility_new(gamma, dfrac_new(1,j));
        gamma = gamma - fjac\fval; 
        if norm(fval) < tol, break, end 
    end
    cutoff_new(1,j) = gamma.^-1; % Risk tolerance (Inverse of Risk Aversion);
end
cpt_new = [-1.0e+77; log(cutoff_new)'; 1.0e+77]; % new bounds
cpt_old

cpt_old =

   1.0e+77 *

   -1.0000
   -0.0000
   -0.0000
   -0.0000
    1.0000

cpt_new

cpt_new =

   1.0e+77 *

   -1.0000
   -0.0000
   -0.0000
   -0.0000
    1.0000

clear all;
load ../Output/MATLAB_sample;
global model 
model = 11;
itertime = clock;
disp(datestr(itertime,0));
22-Aug-2023 16:44:07
dfile = ['Model_',int2str(model),'_',datestr(clock,1),'.out'];
diary(dfile);
disp('Model 11')
Model 11
EstimateRisk(RISK_1993, RISK_2002, RISK_2004, RISK_2006, RISK_2010, RISK_2012, RISK_2014,[X93(:,1),ones(N,1)],[X02(:,1),ones(N,1)],[X04(:,1),ones(N,1)],[X06(:,1),ones(N,1)],[X10(:,1),zeros(N,1)],[X12(:,1),zeros(N,1)],[X14(:,1),zeros(N,1)]);
Error at iteration 1 = 8.36e-01
22-Aug-2023 16:44:24
{Unrecognized function or variable 'mprint'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('EstimateRisk', 'C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m', 190)" style="font-weight:bold">EstimateRisk</a> (<a href="matlab: opentoline('C:\Users\uctpcpp\Desktop\mres-dissertation\Modifed MATLAB code\Codes\EstimateRisk.m',190,0)">line 190</a>)
        mprint([b,b./se,d],info)
} 
clear all;
load ../Output/MATLAB_sample;
global model 
model = 11;
itertime = clock;
disp(datestr(itertime,0));
22-Aug-2023 16:48:00
dfile = ['Model_',int2str(model),'_',datestr(clock,1),'.out'];
diary(dfile);
disp('Model 11')
Model 11
EstimateRisk(RISK_1993, RISK_2002, RISK_2004, RISK_2006, RISK_2010, RISK_2012, RISK_2014,[X93(:,1),ones(N,1)],[X02(:,1),ones(N,1)],[X04(:,1),ones(N,1)],[X06(:,1),ones(N,1)],[X10(:,1),zeros(N,1)],[X12(:,1),zeros(N,1)],[X14(:,1),zeros(N,1)]);
Error at iteration 1 = 8.36e-01
22-Aug-2023 16:48:17
                                   estimate          t-stat            step 
Constant                             -0.964         -30.289        0.836116 
Status Quo Bias                       0.211           5.715        0.311085 
Std Dev                               0.342          16.305       -0.407734 
Original Persistent Std Dev           0.593          15.914       -0.157100 
SQB-Free Persistent Std Dev           0.630          19.669       -0.120014 
Original Transitory Std Dev           1.397          94.385       -0.003347 
SQB-Free Transitory Std Dev           1.710          44.774        0.310392 

Log-likelihood   -46823.6
Error at iteration 2 = 4.46e-01
22-Aug-2023 16:48:35
                                   estimate          t-stat            step 
Constant                             -0.518         -19.542        0.445791 
Status Quo Bias                       0.259           8.497        0.047941 
Std Dev                               0.392          10.056        0.049463 
Original Persistent Std Dev           0.381           8.189       -0.211402 
SQB-Free Persistent Std Dev           0.540          14.193       -0.090244 
Original Transitory Std Dev           1.411          93.087        0.014831 
SQB-Free Transitory Std Dev           1.980          55.112        0.269980 

Log-likelihood   -40100.8
Error at iteration 3 = 3.91e-01
22-Aug-2023 16:48:52
                                   estimate          t-stat            step 
Constant                             -0.187          -6.068        0.330756 
Status Quo Bias                       0.087           2.575       -0.171628 
Std Dev                               0.782          22.033        0.390586 
Original Persistent Std Dev           0.311           5.177       -0.070340 
SQB-Free Persistent Std Dev           0.420           9.097       -0.119952 
Original Transitory Std Dev           1.460          94.348        0.048243 
SQB-Free Transitory Std Dev           1.950          48.172       -0.030573 

Log-likelihood   -38305.1
Error at iteration 4 = 1.09e-01
22-Aug-2023 16:49:09
                                   estimate          t-stat            step 
Constant                             -0.078          -2.296        0.109438 
Status Quo Bias                       0.113           3.180        0.025324 
Std Dev                               0.830          34.586        0.047763 
Original Persistent Std Dev           0.351           3.935        0.039574 
SQB-Free Persistent Std Dev           0.302           4.294       -0.118033 
Original Transitory Std Dev           1.473          91.013        0.012996 
SQB-Free Transitory Std Dev           1.981          45.985        0.031028 

Log-likelihood   -37853.1
Error at iteration 5 = 4.76e-01
22-Aug-2023 16:49:27
                                   estimate          t-stat            step 
Constant                             -0.071          -2.032        0.006499 
Status Quo Bias                       0.127           3.463        0.013890 
Std Dev                               0.844          35.757        0.013447 
Original Persistent Std Dev           0.826           7.446        0.475584 
SQB-Free Persistent Std Dev           0.064           0.703       -0.238252 
Original Transitory Std Dev           1.464          88.678       -0.008955 
SQB-Free Transitory Std Dev           2.007          46.802        0.025909 

Log-likelihood   -37799.7
Error at iteration 6 = 4.30e-01
22-Aug-2023 16:49:45
                                   estimate          t-stat            step 
Constant                             -0.039          -1.101        0.032737 
Status Quo Bias                       0.100           2.744       -0.026516 
Std Dev                               0.891          42.394        0.047370 
Original Persistent Std Dev           1.257          16.388        0.430329 
SQB-Free Persistent Std Dev          -0.080          -1.517       -0.143137 
Original Transitory Std Dev           1.303          58.027       -0.161166 
SQB-Free Transitory Std Dev           2.031          53.094        0.024426 

Log-likelihood   -37758.4
Error at iteration 7 = 1.07e-01
22-Aug-2023 16:50:03
                                   estimate          t-stat            step 
Constant                             -0.048          -1.343       -0.009331 
Status Quo Bias                       0.118           3.214        0.017441 
Std Dev                               0.896          44.384        0.004934 
Original Persistent Std Dev           1.131          20.688       -0.126131 
SQB-Free Persistent Std Dev           0.028           0.812        0.107195 
Original Transitory Std Dev           1.310          67.409        0.007713 
SQB-Free Transitory Std Dev           2.026          52.541       -0.005495 

Log-likelihood   -37732.9
Error at iteration 8 = 1.45e-02
22-Aug-2023 16:50:20
                                   estimate          t-stat            step 
Constant                             -0.050          -1.412       -0.002124 
Status Quo Bias                       0.113           3.135       -0.004051 
Std Dev                               0.894          45.605       -0.001949 
Original Persistent Std Dev           1.145          20.474        0.014459 
SQB-Free Persistent Std Dev          -0.040          -1.109       -0.067327 
Original Transitory Std Dev           1.304          66.431       -0.006344 
SQB-Free Transitory Std Dev           2.022          53.033       -0.003550 

Log-likelihood   -37727.7
Error at iteration 9 = 7.67e-02
22-Aug-2023 16:50:38
                                   estimate          t-stat            step 
Constant                             -0.051          -1.428       -0.000517 
Status Quo Bias                       0.114           3.161        0.000795 
Std Dev                               0.894          45.463       -0.000133 
Original Persistent Std Dev           1.141          20.572       -0.004052 
SQB-Free Persistent Std Dev           0.037           1.041        0.076660 
Original Transitory Std Dev           1.304          66.934        0.000225 
SQB-Free Transitory Std Dev           2.021          53.083       -0.000660 

Log-likelihood   -37728.6
Error at iteration 10 = 4.09e-04
22-Aug-2023 16:50:56
                                   estimate          t-stat            step 
Constant                             -0.051          -1.432       -0.000096 
Status Quo Bias                       0.114           3.161       -0.000082 
Std Dev                               0.894          45.545       -0.000021 
Original Persistent Std Dev           1.141          20.563        0.000409 
SQB-Free Persistent Std Dev          -0.037          -1.056       -0.074393 
Original Transitory Std Dev           1.304          66.897       -0.000202 
SQB-Free Transitory Std Dev           2.021          53.122       -0.000253 

Log-likelihood   -37728.4
Error at iteration 11 = 7.48e-02
22-Aug-2023 16:51:13
                                   estimate          t-stat            step 
Constant                             -0.051          -1.432       -0.000021 
Status Quo Bias                       0.114           3.162        0.000027 
Std Dev                               0.894          45.535       -0.000018 
Original Persistent Std Dev           1.141          20.567       -0.000107 
SQB-Free Persistent Std Dev           0.037           1.053        0.074848 
Original Transitory Std Dev           1.304          66.915       -0.000000 
SQB-Free Transitory Std Dev           2.021          53.126       -0.000027 

Log-likelihood   -37728.4
Error at iteration 12 = 7.62e-06
22-Aug-2023 16:51:31
                                   estimate          t-stat            step 
Constant                             -0.051          -1.433       -0.000004 
Status Quo Bias                       0.114           3.162       -0.000001 
Std Dev                               0.894          45.539        0.000002 
Original Persistent Std Dev           1.141          20.567        0.000008 
SQB-Free Persistent Std Dev          -0.037          -1.053       -0.074733 
Original Transitory Std Dev           1.304          66.914       -0.000006 
SQB-Free Transitory Std Dev           2.021          53.128       -0.000013 

Log-likelihood   -37728.4
Error at iteration 13 = 7.48e-02
22-Aug-2023 16:51:49
                                   estimate          t-stat            step 
Constant                             -0.051          -1.433       -0.000001 
Status Quo Bias                       0.114           3.162        0.000001 
Std Dev                               0.894          45.539       -0.000001 
Original Persistent Std Dev           1.141          20.567       -0.000002 
SQB-Free Persistent Std Dev           0.037           1.053        0.074755 
Original Transitory Std Dev           1.304          66.914       -0.000000 
SQB-Free Transitory Std Dev           2.021          53.128       -0.000001 

Log-likelihood   -37728.4
Error at iteration 14 = 1.66e-07
22-Aug-2023 16:52:07
                                   estimate          t-stat            step 
Constant                             -0.051          -1.433       -0.000000 
Status Quo Bias                       0.114           3.162        0.000000 
Std Dev                               0.894          45.539        0.000000 
Original Persistent Std Dev           1.141          20.567       -0.000000 
SQB-Free Persistent Std Dev          -0.037          -1.053       -0.074750 
Original Transitory Std Dev           1.304          66.914       -0.000000 
SQB-Free Transitory Std Dev           2.021          53.128       -0.000001 

Log-likelihood   -37728.4
Estimates of Model 11.0
22-Aug-2023 16:52:07
Sample size 12686
Number of iterations = 14
Error at last iteration = 1.66e-07
                                   estimate      std. error          t-stat 
Constant                             -0.051           0.035          -1.433 
Status Quo Bias                       0.114           0.036           3.162 
Std Dev                               0.894           0.020          45.539 
Original Persistent Std Dev           1.141           0.055          20.567 
SQB-Free Persistent Std Dev          -0.037           0.035          -1.053 
Original Transitory Std Dev           1.304           0.019          66.914 
SQB-Free Transitory Std Dev           2.021           0.038          53.128 

Log-likelihood   -37728.4
diary off;
